/*! For license information please see taskpane.js.LICENSE.txt */
!function(){"use strict";var e={58394:function(e,t,n){e.exports=n.p+"9810c66357fdc2e1eafc.css"}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r](i,i.exports,n),i.exports}n.m=e,n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&"SCRIPT"===t.currentScript.tagName.toUpperCase()&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");if(r.length)for(var o=r.length-1;o>-1&&(!e||!/^http(s?):/.test(e));)e=r[o--].src}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/^blob:/,"").replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b="undefined"!=typeof document&&document.baseURI||self.location.href,function(){function e(){var n,r,o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.toStringTag||"@@toStringTag";function c(e,o,i,a){var c=o&&o.prototype instanceof s?o:s,l=Object.create(c.prototype);return t(l,"_invoke",function(e,t,o){var i,a,c,s=0,l=o||[],d=!1,f={p:0,n:0,v:n,a:p,f:p.bind(n,4),d:function(e,t){return i=e,a=0,c=n,f.n=t,u}};function p(e,t){for(a=e,c=t,r=0;!d&&s&&!o&&r<l.length;r++){var o,i=l[r],p=f.p,m=i[2];e>3?(o=m===t)&&(c=i[(a=i[4])?5:(a=3,3)],i[4]=i[5]=n):i[0]<=p&&((o=e<2&&p<i[1])?(a=0,f.v=t,f.n=i[1]):p<m&&(o=e<3||i[0]>t||t>m)&&(i[4]=e,i[5]=t,f.n=m,a=0))}if(o||e>1)return u;throw d=!0,t}return function(o,l,m){if(s>1)throw TypeError("Generator is already running");for(d&&1===l&&p(l,m),a=l,c=m;(r=a<2?n:c)||!d;){i||(a?a<3?(a>1&&(f.n=-1),p(a,c)):f.n=c:f.v=c);try{if(s=2,i){if(a||(o="next"),r=i[o]){if(!(r=r.call(i,c)))throw TypeError("iterator result is not an object");if(!r.done)return r;c=r.value,a<2&&(a=0)}else 1===a&&(r=i.return)&&r.call(i),a<2&&(c=TypeError("The iterator does not provide a '"+o+"' method"),a=1);i=n}else if((r=(d=f.n<0)?c:e.call(t,f))!==u)break}catch(e){i=n,a=1,c=e}finally{s=1}}return{value:r,done:d}}}(e,i,a),!0),l}var u={};function s(){}function l(){}function d(){}r=Object.getPrototypeOf;var f=[][i]?r(r([][i]())):(t(r={},i,function(){return this}),r),p=d.prototype=s.prototype=Object.create(f);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,t(e,a,"GeneratorFunction")),e.prototype=Object.create(p),e}return l.prototype=d,t(p,"constructor",d),t(d,"constructor",l),l.displayName="GeneratorFunction",t(d,a,"GeneratorFunction"),t(p),t(p,a,"Generator"),t(p,i,function(){return this}),t(p,"toString",function(){return"[object Generator]"}),(e=function(){return{w:c,m:m}})()}function t(e,n,r,o){var i=Object.defineProperty;try{i({},"",{})}catch(e){i=0}t=function(e,n,r,o){function a(n,r){t(e,n,function(e){return this._invoke(n,r,e)})}n?i?i(e,n,{value:r,enumerable:!o,configurable:!o,writable:!o}):e[n]=r:(a("next",0),a("throw",1),a("return",2))},t(e,n,r,o)}function n(e,t,n,r,o,i,a){try{var c=e[i](a),u=c.value}catch(e){return void n(e)}c.done?t(u):Promise.resolve(u).then(r,o)}function r(e){return function(){var t=this,r=arguments;return new Promise(function(o,i){var a=e.apply(t,r);function c(e){n(a,o,i,c,u,"next",e)}function u(e){n(a,o,i,c,u,"throw",e)}c(void 0)})}}function o(){return i.apply(this,arguments)}function i(){return i=r(e().m(function t(){var n,o,i,a,c,u,s,l,d,f,p,m,v,g,h,y,b,E,w,k,x,T,B,I,O,j,S,P,C,L,R,N,_,Q,G,F;return e().w(function(t){for(;;)switch(t.p=t.n){case 0:if(console.debug("submitForm invoked"),p=(null===(n=document.getElementById("bic_prefix"))||void 0===n?void 0:n.value)||"",m=(null===(o=document.getElementById("bic"))||void 0===o?void 0:o.value)||"",v=(null===(i=document.getElementById("bank_code"))||void 0===i?void 0:i.value)||"",g=(null===(a=document.getElementById("amount"))||void 0===a?void 0:a.value)||"",h=(null===(c=document.getElementById("currency"))||void 0===c?void 0:c.value)||"",y=(null===(u=document.getElementById("vs"))||void 0===u?void 0:u.value)||"",b=(null===(s=document.getElementById("ss"))||void 0===s?void 0:s.value)||"",E=(null===(l=document.getElementById("ks"))||void 0===l?void 0:l.value)||"",w=(null===(d=document.getElementById("msg_input"))||void 0===d?void 0:d.value)||"",k=(null===(f=document.getElementById("qr_dest"))||void 0===f?void 0:f.value)||"",x=document.getElementById("response"),(T=document.getElementById("generateQrButton"))&&(T.disabled=!0),x&&(x.innerText="Generating…"),B=[],m&&""!==m.trim()||B.push("Číslo účtu"),v&&""!==v.trim()||B.push("Kód banky"),g&&""!==g.trim()||B.push("Částka"),k&&""!==k.trim()||B.push("Cíl QR"),!(B.length>0)){t.n=1;break}return x&&(x.innerText="Pole chybí: "+B.join(", ")),T&&(T.disabled=!1),t.a(2);case 1:if(I=Number(g.toString().replace(",",".")),!(Number.isNaN(I)||I<=0)){t.n=2;break}return x&&(x.innerText="Neplatná částka; zadejte prosím kladné číslo."),T&&(T.disabled=!1),t.a(2);case 2:return O=new URLSearchParams,p&&O.set("accountPrefix",p),m&&O.set("accountNumber",m),v&&O.set("bankCode",v),I&&O.set("amount",I.toString()),h&&O.set("currency",h),y&&O.set("vs",y),E&&O.set("ks",E),b&&O.set("ss",b),w&&O.set("message",w),j="".concat("https://api.paylibo.com/paylibo/generator/czech/image","?").concat(O.toString()),console.debug("Full API URL will be called:",j),t.p=3,t.n=4,fetch(j);case 4:if((S=t.v).ok){t.n=5;break}throw new Error("Network response was not ok");case 5:return t.n=6,S.blob();case 6:return P=t.v,t.n=7,P.arrayBuffer();case 7:for(C=t.v,L=new Uint8Array(C),R="",N=0;N<L.length;N+=32768)_=L.subarray(N,N+32768),R+=String.fromCharCode.apply(null,_);if(Q=btoa(R),"undefined"==typeof Excel||!Excel.run){t.n=9;break}return t.n=8,Excel.run(function(){var t=r(e().m(function t(n){var r,o,i,a;return e().w(function(e){for(;;)switch(e.p=e.n){case 0:return e.p=0,r=n.workbook.worksheets.getActiveWorksheet(),(o=r.getRange(k)).load(["left","top","width","height"]),e.n=1,n.sync();case 1:return(i=r.shapes.addImage(Q)).left=o.left,i.top=o.top,document.getElementById("fitToCell")&&document.getElementById("fitToCell").checked&&(i.width=o.width,i.height=o.height),e.n=2,n.sync();case 2:console.log("Image inserted successfully"),x&&(x.innerText="QR image generated and inserted successfully."),e.n=4;break;case 3:e.p=3,a=e.v,x&&(x.innerText="Chyba vložení QR kodu: "+(a&&a.message)),console.error("Error inserting image:",a);case 4:return e.a(2)}},t,null,[[0,3]])}));return function(e){return t.apply(this,arguments)}}());case 8:t.n=10;break;case 9:(G=document.createElement("img")).src="data:image/png;base64,".concat(Q),G.style.maxWidth="150px",G.style.maxHeight="150px",x&&(x.innerHTML="",x.appendChild(G)),x&&(x.innerText="QR generován úspěšně.");case 10:t.n=12;break;case 11:t.p=11,F=t.v,x&&(x.innerText="Chyba načtení QR kodu: "+(F&&F.message)),console.error("Error fetching image:",F);case 12:return t.p=12,T&&(T.disabled=!1),t.f(12);case 13:return t.a(2)}},t,null,[[3,11,12,13]])})),i.apply(this,arguments)}Office.onReady(function(e){if(e.host===Office.HostType.Excel){var t=document.getElementById("generateQrButton");t&&t.addEventListener("click",o),console.debug("Office.onReady: Excel host detected. Event bound.")}try{var n=window.matchMedia("(prefers-color-scheme: dark)"),r=function(e){var t=e&&void 0!==e.matches?e.matches:n.matches||!1;document.body.setAttribute("data-theme",t?"dark":"light")};n.addEventListener?n.addEventListener("change",r):n.addListener&&n.addListener(r),r()}catch(e){console.debug("Theme detection not available",e)}}),document.addEventListener("DOMContentLoaded",function(){var e=document.getElementById("generateQrButton");e&&e.addEventListener("click",o),console.debug("DOMContentLoaded: Event bound for button")})}(),new URL(n(58394),n.b)}();
//# sourceMappingURL=taskpane.js.map