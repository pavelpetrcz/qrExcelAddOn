<!DOCTYPE html>
<html>

<head>
    <title>Platební QR kód</title>
    <style>
        body {
            margin: 50px;
            font-family: Tahoma, sans-serif;
            font-size: small;
        }

        .wrapper {
            display: grid;
            grid-template-columns: 33% 33% 33%;
            grid-gap: 3px;
            background-color: #fff;
            color: #444;
        }

        .box {
            border-radius: 3px;
            padding: 3px;
            font-size: 100%;
        }

        .bic_label {
            grid-column: 1 / 4;
            grid-row: 1;
        }

        .bic_prefix {
            grid-column: 1 / 1;
            grid-row: 2;
        }

        .bic {
            grid-column: 2 / 4;
            grid-row: 2;
        }

        .bank_code {
            grid-column: 1 / 4;
            grid-row: 3;
        }

        .am_label {
            grid-column: 1 / 3;
            grid-row: 4;
        }

        .am_input {
            grid-column: 1 / 3;
            grid-row: 5;
        }

        .curr_label {
            grid-column: 3 / 4;
            grid-row: 4;
        }

        .curr_input {
            grid-column: 3 / 4;
            grid-row: 5;
        }

        .vs_label {
            grid-column: 1 / 2;
            grid-row: 7;
        }

        .ss_label {
            grid-column: 2 / 3;
            grid-row: 7;
        }

        .ks_label {
            grid-column: 3 / 4;
            grid-row: 7;
        }

        .vs_input {
            grid-column: 1 / 2;
            grid-row: 8;
        }

        .ss_input {
            grid-column: 2 / 3;
            grid-row: 8;
        }

        .ks_input {
            grid-column: 3 / 4;
            grid-row: 8;
        }

        .msg {
            grid-column: 1 / 4;
            grid-row: 9;
        }

        .msg_input {
            grid-column: 1 / 4;
            grid-row: 10;
        }

        .separator {
            grid-column: 1 / 4;
            grid-row: 11;
        }

        .qr_dest_label {
            grid-column: 1 / 4;
            grid-row: 12;
        }

        .qr_dest_input {
            grid-column: 1 / 4;
            grid-row: 13;
        }

        hr {
            border: 3px solid #f08017;
            width: 100%;
            /* Adjust width as needed */
            margin: 5x auto;
            /* Center the line */
        }

        h1 {
            text-align: center;
        }

        label {
            display: block;
        }

        input,
        select {
            width: 100%;
            padding: 10px;
            border: 2px solid #908b87eb;
            border-radius: 4px;
            box-sizing: border-box;
            margin-bottom: 2px;
            background-color: rgb(255, 255, 255);
        }

        button {
            background-color: #f08017;
            /* Green */
            border: none;
            color: white;
            padding: 15px 32px;
            text-align: center;
            text-decoration: none;
            display: inline-block;
            font-size: 16px;
            margin: 10px 2px;
            cursor: pointer;
            border-radius: 4px;
        }

        #currency {
            background-color: rgb(235, 232, 232);
        }

        #response {
            margin-top: 20px;
        }
    </style>
</head>

<body>
    <h1>Platební QR kód</h1>
    <p><i>Povinná pole označena hvězdičkou.</i></p>
    <form id="myForm">
        <div class="wrapper">
            <div class="box bic_label">
                <label for="bic_prefix">Předčíslí, číslo účtu*, kód banky*</label>
            </div>

            <div class="box bic_prefix">
                <input id="bic_prefix" name="bic_prefix" required placeholder="000000"><br>
            </div>

            <div class="box bic">
                <input id="bic" name="bic" required placeholder="0000000000"><br>
            </div>

            <div class="box bank_code">
                <select id="bank_code" class="dropdown" name="bank_code" required placeholder="0000"><br>
                    <option value="0100">0100 - Komerční banka, a.s.</option>
                    <option value="0300">0300 - Československá obchodní banka, a. s.</option>
                    <option value="0600">0600 - MONETA Money Bank, a.s.</option>
                    <option value="0710">0710 - ČESKÁ NÁRODNÍ BANKA</option>
                    <option value="0800">0800 - Česká spořitelna, a.s.</option>
                    <option value="2010">2010 - Fio banka, a.s.</option>
                    <option value="2060">2060 - Citfin, spořitelní družstvo</option>
                    <option value="2070">2070 - TRINITY BANK a.s.</option>
                    <option value="2100">2100 - ČSOB Hypoteční banka, a.s.</option>
                    <option value="2200">2200 - Peněžní dům, spořitelní družstvo</option>
                    <option value="2220">2220 - Artesa, spořitelní družstvo</option>
                    <option value="2250">2250 - Banka CREDITAS a.s.</option>
                    <option value="2260">2260 - NEY spořitelní družstvo</option>
                    <option value="2275">2275 - Podnikatelská družstevní záložna</option>
                    <option value="2600">2600 - Citibank Europe plc, organizační složka</option>
                    <option value="2700">2700 - UniCredit Bank Czech Republic and Slovakia, a.s.</option>
                    <option value="3030">3030 - Air Bank a.s.</option>
                    <option value="3060">3060 - PKO BP S.A., Czech Branch</option>
                    <option value="3500">3500 - ING Bank N.V.</option>
                    <option value="4000">4000 - Max banka a.s.</option>
                    <option value="4300">4300 - Národní rozvojová banka, a.s.</option>
                    <option value="5500">5500 - Raiffeisenbank a.s.</option>
                    <option value="5800">5800 - J&amp;T BANKA, a.s.</option>
                    <option value="6000">6000 - PPF banka a.s.</option>
                    <option value="6200">6200 - COMMERZBANK Aktiengesellschaft, pobočka Praha</option>
                    <option value="6210">6210 - mBank S.A., organizační složka</option>
                    <option value="6300">6300 - BNP Paribas S.A., pobočka Česká republika</option>
                    <option value="6363">6363 - Partners Banka, a.s.</option>
                    <option value="6700">6700 - Všeobecná úverová banka a.s., pobočka Praha</option>
                    <option value="6800">6800 - Sberbank CZ, a.s. v likvidaci</option>
                    <option value="7910">7910 - Deutsche Bank Aktiengesellschaft Filiale Prag, organizační složka
                    </option>
                    <option value="7950">7950 - Raiffeisen stavební spořitelna a.s.</option>
                    <option value="7960">7960 - ČSOB Stavební spořitelna, a.s.</option>
                    <option value="7970">7970 - MONETA Stavební Spořitelna, a.s.</option>
                    <option value="7990">7990 - Modrá pyramida stavební spořitelna, a.s.</option>
                    <option value="8030">8030 - Volksbdank Raiffeisenbank Nordoberpfalz eG pobočka Cheb</option>
                    <option value="8040">8040 - Oberbank AG pobočka Česká republika</option>
                    <option value="8060">8060 - Stavební spořitelna České spořitelny, a.s.</option>
                    <option value="8090">8090 - Česká exportní banka, a.s.</option>
                    <option value="8150">8150 - HSBC Continental Europe, Czech Republic</option>
                    <option value="8190">8190 - Sparkasse Oberlausitz-Niederschlesien</option>
                    <option value="8198">8198 - FAS finance company s.r.o.</option>
                    <option value="8220">8220 - Payment execution s.r.o.</option>
                    <option value="8250">8250 - Bank of China (CEE) Ltd. Prague Branch</option>
                    <option value="8255">8255 - Bank of Communications Co., Ltd., Prague Branch odštěpný závod</option>
                    <option value="8265">8265 - Industrial and Commercial Bank of China Limited, Prague Branch, odštěpn
                        závod</option>
                    <option value="8280">8280 - B-Efekt a.s.</option>
                    <option value="8500">8500 - Multitude Bank p.l.c.</option>
                </select>
            </div>

            <div class="box am_label">
                <label for="amount">Částka*</label>
            </div>

            <div class="box am_input">
                <input id="amount" name="amount" required placeholder="1000"><br>
            </div>

            <div class="box curr_label">
                <label for="currency">Měna</label>
            </div>

            <div class="box curr_input">
                <input id="currency" name="currency" disabled value="CZK"><br>
            </div>

            <div class="box vs_label">
                <label for="vs">VS</label>
            </div>

            <div class="box vs_input">
                <input id="vs" name="vs" placeholder="0000000000"><br>
            </div>

            <div class="box ss_label">
                <label for="ss">SS</label>
            </div>

            <div class="box ss_input">
                <input id="ss" name="ss" placeholder="0000000000"><br>
            </div>

            <div class="box ks_label">
                <label for="ks">KS</label>
            </div>

            <div class="box ks_input">
                <input id="ks" name="ks" placeholder="0000"><br>
            </div>

            <div class="box msg">
                <label for="msg_input">Zpráva pro příjemce</label>
            </div>

            <div class="box msg_input">
                <input id="msg_input" name="msg_input" placeholder="Peníze za ..."><br>
            </div>

            <div class="box separator">
                <hr>
            </div>

            <div class="box qr_dest_label">
                <label for="qr_dest">Cíl QR*</label>
            </div>
            <div class="box qr_dest_input">
                <input id=" " name="qr_dest" required placeholder="E2"><br>
            </div>
        </div>
        <button type="button" id="generateQrButton" onclick="submitForm()">Generovat platební QR kód</button>
    </form>
    <div id="response"></div>

    <script>
        function submitForm() {
            const accountPrefix = document.getElementById('bic_prefix').value;
            const accountNumber = document.getElementById('bic').value;
            const bankCode = document.getElementById('bank_code').value;
            const amount = document.getElementById('amount').value;
            const currency = document.getElementById('currency').value;
            const vs = document.getElementById('vs').value;
            const ss = document.getElementById('ss').value;
            const ks = document.getElementById('ks').value;
            const message = document.getElementById('msg_input').value;
            const qr_dest = document.getElementById('qr_dest').value;

            // Define the API endpoint URL
            const apiUrl = 'http://api.paylibo.com/paylibo/generator/czech/image';

            // Build the query string with parameters
            const queryString = new URLSearchParams({
                accountPrefix,
                accountNumber,
                bankCode,
                amount,
                currency,
                vs,
                ks,
                ss,
                message
            });

            // Construct the full URL with query string
            const fullUrl = `${apiUrl}?${queryString.toString()}`;

            // Make the API call using Fetch API
            try {
                fetch(fullUrl)
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const blob = response.blob();
                const
                    objectUrl = URL.createObjectURL(blob);

                const img = document.createElement('img');
                img.src = objectUrl;
                document.body.appendChild(img); // Replace with your desired container
            } catch (error) {
                console.error('Error fetching image:', error);
            }

            Excel.run(async (context) => {
                try {
                    const imageData = new Uint8Array(img);

                    const worksheet = context.workbook.worksheets.getItem(sheetName);
                    const shapes = worksheet.shapes;
                    const range = worksheet.getRange(qr_dest);

                    const picture = await shapes.addPictureAsync({
                        data: imageData,
                        left: range.left,
                        top: range.top,
                        width: range.width,
                        height: range.height
                    });

                    await context.sync();
                    console.log('Image inserted successfully');
                } catch (error) {
                    console.error('Error inserting image:', error);
                }
            });

        }

    </script>
</body>

</html>